<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!--    ìŠ¤ì™€ì´í¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <link
      rel="stylesheet"
      th:href="@{https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css}"
    />
    <!--    ìŠ¤íƒ€ì¼ì‹œíŠ¸(ê¸°ì´ˆì…‹íŒ… css)-->
    <link rel="stylesheet" th:href="@{../css/search.css}" />
    <!--    ìë°”ìŠ¤í¬ë¦½íŠ¸-->
    <script th:src="@{../js/main.js}"></script>
    <!--   ì• ë‹ˆë©”ì´ì…˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <link
      th:href="@{https://unpkg.com/aos@2.3.1/dist/aos.css}"
      rel="stylesheet"
    />
    <!--    <script th:src="@{https://unpkg.com/aos@2.3.1/dist/aos.js}"></script>-->
    <title>ğŸ’ŠYAGIYO</title>
  </head>
  <body>
    <div class="wrapper">
      <!-- Header  -->

      <header>
        <div class="top">
          <div class="logo">
            <a th:href="@{/}">
              <img th:src="@{../img/black-yagiyo.png}" alt=""
            /></a>
          </div>

          <!--      ê²€ìƒ‰ì–´   -->
          <div class="search_box">
            <form th:action="@{/search}" method="get">
              <input type="text" name="query" value="" />
              <button type="submit"></button>
            </form>
            <!-- <p id="recent-search"></p> -->
          </div>

          <nav class="gnb_box">
            <a th:href="@{/name}">AIë¶„ì„</a>
            <a href="">ì»¤ë®¤ë‹ˆí‹°</a>
            <a href="">ì•½êµ­ì •ë³´</a>
            <div th:if="${!session.isEmpty()}">
              <p th:text="${session.loginMember.gubun}"></p>
            </div>
            <div>
              <th:bolck class="login" th:if="${session.isEmpty()}">
                <a href="" th:href="@{/login}">ë¡œê·¸ì¸</a>
              </th:bolck>
              <th:bolck class="logout" th:unless="${session.isEmpty()}">
                <a href="" th:href="@{/logout}">ë¡œê·¸ì•„ì›ƒ</a>
              </th:bolck>
            </div>
          </nav>
        </div>
      </header>

      <a class="banner" th:href="@{/nutrients/ì˜¤ë©”ê°€3}">
        <div class="banner_text">
          ì˜¤ë©”ê°€3ëŠ” ìƒì„ ì´ë‚˜ í•´ì¡°ë¥˜ì—ì„œ ì¶”ì¶œí•œ ì—¬ëŸ¬ ì¢…ë¥˜ì˜ ë¶ˆí¬í™”ì§€ë°©ì‚°ì„ ë¶€ë¥´ëŠ”
          ë§ì´ì—ìš”. ê·¸ ì¤‘ ê°€ì¥ ì¤‘ìš”í•œ ê²ƒì€ EPAì™€ DHAì—ìš”. Â·
        </div>
      </a>

      <div class="main">
        <div
          class="item_cards"
          th:replace="~{fragments/apple :: header}"
          id="apple-header"
        ></div>
        <div
          th:replace="~{fragments/apple :: footer}"
          id="apple-footer"
          th:class="item_cards"
        ></div>
      </div>

      <footer>
        <div class="footer_area">
          <div class="top">
            <img
              class="footer_img"
              th:src="@{../img/white-yagiyo.png}"
              alt=""
            />
            <div class="footer_menu">
              <a href="">ì´ìš©ì•½ê´€</a>
              <a href="">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
            </div>
          </div>
        </div>
        <!--footer - bottom  -->

        <div class="bottom">
          <div class="info">
            <span class="title">ì£¼(ì•¼ê¸°ìš”)</span>
            <p></p>
          </div>
        </div>

        <!--footer - copyright -->

        <div class="copyright">
          <p>Copyright 2023 YAGIYO. Allrights reserved.</p>
        </div>
      </footer>
    </div>
    <script>
      const query = new URLSearchParams(window.location.search).get('query');
      if (query === 'ì˜¤ë©”ê°€') {
        document.getElementById('apple-header').style.display = 'flex';
        document.getElementById('apple-footer').style.display = 'none';
      } else {
        document.getElementById('apple-header').style.display = 'none';
        document.getElementById('apple-footer').style.display = 'flex';
      }
    </script>

    <script>
      // ê²€ìƒ‰ì–´ë¥¼ localStorageì— ì €ì¥í•˜ëŠ” í•¨ìˆ˜
      function saveSearch(query) {
        // ìµœê·¼ ê²€ìƒ‰ì–´ ë°°ì—´ì„ ê°€ì ¸ì˜´
        const recentSearches =
          JSON.parse(localStorage.getItem('recentSearches')) || [];

        // ê²€ìƒ‰ì–´ê°€ ì´ë¯¸ ìµœê·¼ ê²€ìƒ‰ì–´ì— ìˆìœ¼ë©´ ì‚­ì œ
        const index = recentSearches.indexOf(query);
        if (index !== -1) {
          recentSearches.splice(index, 1);
        }

        // ê²€ìƒ‰ì–´ë¥¼ ìµœê·¼ ê²€ìƒ‰ì–´ ë°°ì—´ ë§¨ ì•ì— ì¶”ê°€
        recentSearches.unshift(query);

        // ìµœê·¼ ê²€ìƒ‰ì–´ ë°°ì—´ì„ localStorageì— ì €ì¥
        localStorage.setItem('recentSearches', JSON.stringify(recentSearches));
      }

      // ìµœê·¼ ê²€ìƒ‰ì–´ë¥¼ ë³´ì—¬ì£¼ëŠ” í•¨ìˆ˜
      function showRecentSearches() {
        // ìµœê·¼ ê²€ìƒ‰ì–´ ë°°ì—´ì„ ê°€ì ¸ì˜´
        const recentSearches =
          JSON.parse(localStorage.getItem('recentSearches')) || [];

        // ìµœê·¼ ê²€ìƒ‰ì–´ë¥¼ p íƒœê·¸ì— ì¶”ê°€
        const recentSearchEl = document.getElementById('recent-search');
        if (recentSearches.length > 0) {
          recentSearchEl.innerText = `ìµœê·¼ ê²€ìƒ‰ì–´: ${recentSearches.join(
            ', ',
          )}`;
        } else {
          recentSearchEl.innerText = '';
        }
      }

      // í˜ì´ì§€ ë¡œë“œì‹œ ìµœê·¼ ê²€ìƒ‰ì–´ë¥¼ ë³´ì—¬ì¤Œ
      showRecentSearches();

      // ê²€ìƒ‰ì–´ë¥¼ submit í•  ë•Œ ìµœê·¼ ê²€ìƒ‰ì–´ë¥¼ localStorageì— ì €ì¥í•˜ê³  ë³´ì—¬ì¤Œ
      const form = document.querySelector('form');
      form.addEventListener('submit', function (e) {
        e.preventDefault();
        const query = this.querySelector('input[name="query"]').value;
        saveSearch(query);
        showRecentSearches();
        this.submit();
      });
    </script>

    <!--page ìƒˆë¡œê³ ì¹¨ì‹œì— /search ë¡œ ì´ë™-->
    <!--        <script type="text/javascript">-->
    <!--            window.onload = function () {-->
    <!--                if (location.pathname === "/search") {-->
    <!--                    if (performance.navigation.type == 1) {-->
    <!--                        window.location.href = "/search";-->
    <!--                    }-->
    <!--                }-->
    <!--            };-->
    <!--        </script>-->
  </body>
</html>
